import{r as m,C as F,j as e,N as h,s as S}from"./index-a005ff36.js";import{i as q}from"./default-img-a4353d17.js";const v=({id:a,name:N,price:d,img:j,itemCount:x})=>{const{cartItems:c,setCartItems:r,removeFromCart:C}=m.useContext(F),[u,o]=m.useState({inputNumber:x,totalPrice:d}),[b,l]=m.useState("");m.useEffect(()=>{const n=c.find(t=>t.id===a);n&&o({inputNumber:n.itemCount,totalPrice:(n.itemCount*parseFloat(d)).toFixed(2)})},[c,a,d,x]);const p=d,f=u.totalPrice,y=()=>{const n=parseInt(u.inputNumber)||0,t=parseInt(u.inputNumber)>42?42:parseInt(n)+1;t>42?(l("Sorry, but max quantity is 42"),o({inputNumber:42,totalPrice:(42*parseFloat(p)).toFixed(2)})):(l(""),o({inputNumber:t,totalPrice:(t*parseFloat(p)).toFixed(2)}),r(i=>i.map(s=>s.id===a?{...s,itemCount:t}:s)))},k=()=>{if(u.inputNumber!==""){const n=parseInt(u.inputNumber)-1,t=n<=0?1:n;t>42?l("Sorry, but max quantity is 42"):l(""),o({inputNumber:t,totalPrice:(t*parseFloat(p)).toFixed(2)}),r(i=>i.map(s=>s.id===a?{...s,itemCount:t}:s))}};function P(n){const t=parseFloat(n.target.value);if(t>42)l("Sorry, but max quantity is 42"),o({inputNumber:42,totalPrice:(42*parseFloat(p)).toFixed(2)}),r(i=>i.map(s=>s.id===a?{...s,itemCount:42}:s));else if(isNaN(t)||t<0)l(""),o({inputNumber:1,totalPrice:parseFloat(p).toFixed(2)}),r(i=>i.map(s=>s.id===a?{...s,itemCount:1}:s));else if(t==0){l("");const i=t.toString().replace(/^0/,1);o({inputNumber:parseFloat(i),totalPrice:parseFloat(p).toFixed(2)}),r(s=>s.map(g=>g.id===a?{...g,itemCount:t.replace(/^0/,1)}:g))}else l(""),o({inputNumber:t,totalPrice:(t*parseFloat(p)).toFixed(2)}),r(i=>i.map(s=>s.id===a?{...s,itemCount:parseFloat(t)}:s))}function w(n){(n.key===","||n.key==="."||n.key==="+"||n.key==="e"||n.key==="-"||isNaN(n.key)&&n.keyCode!==8)&&n.preventDefault()}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"cart-item",children:[e.jsx(h,{to:`/products/${a}`,children:e.jsx("figure",{children:e.jsx("img",{src:j,alt:"product"})})}),e.jsx(h,{to:`/products/${a}`,className:"product-name",children:N}),e.jsxs("div",{className:"quantity-wrapper",children:[e.jsx("p",{children:b}),e.jsx("button",{className:"decrease",onClick:()=>k(),children:"-"}),e.jsx("input",{type:"number",className:"quantity",value:u.inputNumber,onChange:P,onKeyDown:w}),e.jsx("button",{className:"increase",onClick:()=>y(),children:"+"})]}),e.jsxs("div",{className:"product-price",children:["$ ",f]}),e.jsx("button",{className:"delete",onClick:()=>C(a),children:e.jsx("img",{src:S,alt:"bag"})})]})})},V=()=>{const{cartItems:a,setCartItems:N}=m.useContext(F),[d,j]=m.useState({price:0});return m.useEffect(()=>{const x=a.reduce((c,r)=>c+r.price*r.itemCount,0);j(c=>({...c,price:x}))},[a]),e.jsx(e.Fragment,{children:e.jsx("section",{className:"cart-wrapper",children:e.jsxs("div",{className:"cart-content",children:[a.length>0?a.map(x=>{const{id:c,name:r,price:C,image:u,itemCount:o}=x,b={id:c,name:r,price:C,itemCount:o,img:u||q};return e.jsx(v,{...b},c)}):e.jsxs("div",{className:"text-info",children:[e.jsx("p",{children:"There is nothing in the cart"}),e.jsxs(h,{to:"/products",children:["To the store ",e.jsx("span",{children:" →"})]})]}),a.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"total-wrapper",children:[e.jsx("button",{className:"clean-cart",onClick:()=>N([]),children:"Clean Cart"}),e.jsxs("p",{children:["Total price: ",e.jsxs("span",{children:["$",d.price]})]}),e.jsx("button",{className:"buy",onClick:()=>N([]),children:"Proceed to payment"})]}),e.jsx("div",{className:"text-info",children:e.jsxs(h,{to:"/products",children:["Back to the store ",e.jsx("span",{children:" →"})]})})]}):e.jsx(e.Fragment,{})]})})})};export{V as default};
